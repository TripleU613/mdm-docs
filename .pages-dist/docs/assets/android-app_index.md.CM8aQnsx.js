import{_ as i,c as a,o as l,ae as t}from"./chunks/framework.Cqi9LMMK.js";const h=JSON.parse('{"title":"Android app","description":"","frontmatter":{},"headers":[],"relativePath":"android-app/index.md","filePath":"android-app/index.md"}'),s={name:"android-app/index.md"};function o(n,e,r,c,d,p){return l(),a("div",null,[...e[0]||(e[0]=[t('<h1 id="android-app" tabindex="-1">Android app <a class="header-anchor" href="#android-app" aria-label="Permalink to &quot;Android app&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><ul><li>Config lives in <code>ConfigStore</code> and syncs to <code>devices/{deviceId}/config/state/current/current</code>.</li><li>Per-app policy lives in <code>devices/{deviceId}/apps/{package}</code> and is applied by <code>AppRemoteWatcher</code>.</li><li>Remote commands come from <code>devices/{deviceId}/commands</code>.</li><li>Website admin UI writes config/app policy; see <code>website</code>.</li><li>Full path map + backend notes: <code>firestore-config</code>.</li></ul><h2 id="request-map-android-backend" tabindex="-1">Request map (Android -&gt; backend) <a class="header-anchor" href="#request-map-android-backend" aria-label="Permalink to &quot;Request map (Android -&gt; backend)&quot;">​</a></h2><ul><li>Firebase Auth: sign in, sign up, verify email, password reset.</li><li>Firebase Functions: device binding, recovery PIN, delete account.</li><li>Firestore: config sync, apps policy, commands, remote session, email blocklist check.</li><li>Cloud Run: <code>getLatestGitHubRelease</code> for update checks.</li><li>VPN2 WireGuard: reads <code>devices/{deviceId}.vpn</code> set by backend; see <code>vpn-wireguard</code>.</li></ul><h2 id="home-tab" tabindex="-1">Home tab <a class="header-anchor" href="#home-tab" aria-label="Permalink to &quot;Home tab&quot;">​</a></h2><ul><li>Hi: uses Firebase display name or email prefix; includes Tech Take from <code>metadata/tech_take</code>.</li><li>Policies at a glance: summary grouped by System/Installation/Network/Accessibility.</li><li>Did you know: rotates hardcoded tips on resume.</li><li>Policies applied counter: counts enabled policy chips.</li><li>Managed apps overview: counts managed/total apps and restriction types.</li><li>Whitelist summary: shows active domains; hides internal Firebase hosts.</li><li>App update prompt: modal with Download/Remind/Never when a newer build is found.</li></ul><h2 id="onboarding" tabindex="-1">Onboarding <a class="header-anchor" href="#onboarding" aria-label="Permalink to &quot;Onboarding&quot;">​</a></h2><ul><li>Welcome + terms: must accept; links to privacy policy.</li><li>Sign in: email + password + PIN, then device binding.</li><li>Sign up: <code>isEmailAllowed</code> check, create user, write <code>users/{uid}</code> profile.</li><li>Verify email: reloads user; blocks until verified.</li><li>RegisterActivity: verified -&gt; Auth/Main; unverified -&gt; Verify.</li><li>Password reset: sends Firebase reset email.</li><li>Auth screens show a blocking loading overlay while network requests run.</li><li>Device binding: RSA keypair + Functions <code>requestDeviceBinding</code>/<code>confirmDeviceBinding</code>.</li><li>MDM PIN gate: validates <code>mdm_pin</code>/<code>mdm_pin_hash</code>; can trigger recovery.</li><li>PIN recovery: <code>validateRecoveryPin</code> or email/password -&gt; <code>ResetPinActivity</code>.</li><li>Permissions check: device owner/admin + <code>WRITE_SECURE_SETTINGS</code>; applies defaults and sets <code>setup_complete=true</code>.</li><li>Extra gates: Privacy tab re-checks storage/install packages/VPN consent; <code>bannedEmails</code> can trigger uninstall.</li></ul><h2 id="system-tab" tabindex="-1">System tab <a class="header-anchor" href="#system-tab" aria-label="Permalink to &quot;System tab&quot;">​</a></h2><ul><li>Disallow adding users: applies <code>UserManager.DISALLOW_ADD_USER</code>.</li><li>Disable factory reset: applies <code>UserManager.DISALLOW_FACTORY_RESET</code> and <code>DISALLOW_SAFE_BOOT</code>.</li><li>Block developer options: applies <code>UserManager.DISALLOW_DEBUGGING_FEATURES</code>.</li><li>Disable app settings control: applies <code>UserManager.DISALLOW_APPS_CONTROL</code>.</li><li>Block phone calls: applies <code>UserManager.DISALLOW_OUTGOING_CALLS</code>.</li><li>Disable SMS/MMS: applies <code>UserManager.DISALLOW_SMS</code>.</li></ul><h2 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h2><ul><li>Disable APK install: applies <code>UserManager.DISALLOW_INSTALL_APPS</code>.</li><li>Block new apps: hides + suspends new installs unless approved; approvals from prefs, <code>ConfigStore</code>, and Firestore <code>devices/{deviceId}/apps/{package}</code>.</li><li>Allow user updates: shows Updates link on the PIN screen to open the Updates tab (<code>UpdatesGuestActivity</code>).</li><li>Block Play Store: hides <code>com.android.vending</code>.</li></ul><h2 id="network-tab" tabindex="-1">Network tab <a class="header-anchor" href="#network-tab" aria-label="Permalink to &quot;Network tab&quot;">​</a></h2><ul><li>Disable tethering and hotspot: applies <code>UserManager.DISALLOW_CONFIG_TETHERING</code>.</li><li>Block Wi-Fi: applies <code>UserManager.DISALLOW_CONFIG_WIFI</code> and stores <code>network.wifi_blocked</code>.</li><li>Block all traffic: uses VPN firewall; forces Wi-Fi block while active.</li><li>Enable private DNS: sets <code>private_dns_mode</code> + hostname; requires <code>WRITE_SECURE_SETTINGS</code>.</li><li>Enable VPN firewall: starts <code>AdVpnService</code>, sets Always-On, blocks VPN settings changes; per-app blocks use <code>firewall_rules</code>.</li><li>Whitelist domains: runs <code>WhitelistVpnService</code>, disables Private DNS and main VPN; DNS allowlist via <code>RuleDatabase</code>.</li></ul><h2 id="accessibility-tab" tabindex="-1">Accessibility tab <a class="header-anchor" href="#accessibility-tab" aria-label="Permalink to &quot;Accessibility tab&quot;">​</a></h2><ul><li>Android Auto quirk: returns Home on Google Search/Maps accessibility events.</li><li>Block WhatsApp updates tab: exits if the Updates tab is selected.</li><li>Block WhatsApp channels: detects channel UI; applies penalty timers.</li><li>Block status: detects Status UI; exits (penalty timers).</li><li>Block AI chats: blocks Meta AI, Gemini chats, and Google Photos Create.</li><li>Block all in-app browsers: on blocks all except exception list; off blocks only per-app blocklist.</li><li>Block default browsers: hides/suspends browser-capable apps; blocks default-app changes on Android 14+.</li></ul><h2 id="apps-tab" tabindex="-1">Apps tab <a class="header-anchor" href="#apps-tab" aria-label="Permalink to &quot;Apps tab&quot;">​</a></h2><ul><li>Users apps: launchable apps with no managed flags.</li><li>System apps: non-launchable apps with no managed flags.</li><li>Managed apps: any app with active policy flags.</li><li>Actions: hide, suspend, disable, make offline (VPN), block in-app browser, add WebView exception, block video, block uninstall.</li></ul><h2 id="updates-tab" tabindex="-1">Updates tab <a class="header-anchor" href="#updates-tab" aria-label="Permalink to &quot;Updates tab&quot;">​</a></h2><ul><li>Aurora updater: lists updates via Aurora GPlay API; pull to refresh, update all, swipe to mute; installs require device owner.</li></ul><h2 id="settings-tab" tabindex="-1">Settings tab <a class="header-anchor" href="#settings-tab" aria-label="Permalink to &quot;Settings tab&quot;">​</a></h2><ul><li>Switch to Hebrew: toggles app locale via AppCompatDelegate; stores <code>settings.language</code>.</li><li>Export profile: writes encrypted ConfigStore export plus managed/approved app policies (no pins/auth/uid/email/snapshot).</li><li>Import profile: applies entries + app policies; warns if VPN consent is missing.</li><li>Import whitelist: edits domain whitelist; parses domain lists and saves <code>network.domain_whitelist_hosts</code>.</li><li>Account info: shows signed-in email; copy to clipboard.</li><li>Privacy policy: opens in-app WebView to GitHub <code>Privacy.md</code>.</li><li>Check for app updates: queries latest release and triggers manual update check.</li><li>Support us: opens <code>https://tripleu.org/support</code>.</li><li>App density: applies app-only density scale and stores percent.</li><li>Muted updates: list of muted packages; unmute in dialog.</li><li>Reset MDM PIN: changes PIN and updates <code>auth.pin_sha256</code>.</li><li>Uninstall: reverts policies, clears device owner, starts uninstall.</li><li>Delete my account: calls Firebase <code>deleteAccount</code>, signs out.</li></ul><h2 id="invisible-features" tabindex="-1">Invisible features <a class="header-anchor" href="#invisible-features" aria-label="Permalink to &quot;Invisible features&quot;">​</a></h2><h2 id="lifecycle-session" tabindex="-1">Lifecycle + session <a class="header-anchor" href="#lifecycle-session" aria-label="Permalink to &quot;Lifecycle + session&quot;">​</a></h2><ul><li>App startup bootstrap: defers watchers/services until first resume.</li><li>Boot behavior: restarts VPN/accessibility/app monitor after device boot.</li><li>Session lock: auth resets immediately when app backgrounds.</li><li>Lockout mode: kiosk-style lock driven by <code>system.lockout_enabled</code>.</li></ul><h2 id="identity-admin" tabindex="-1">Identity + admin <a class="header-anchor" href="#identity-admin" aria-label="Permalink to &quot;Identity + admin&quot;">​</a></h2><ul><li>Device identity: generates <code>device-&lt;uuid&gt;</code> and centralizes Firestore paths.</li><li>Device admin receiver selection: picks the active DeviceAdminReceiver (new vs legacy).</li><li>Device info uploader (IMEI): uploads IMEI to <code>users/{uid}</code> when device owner + permission.</li><li>Default policies (first-time setup): network reset block + FRP account + branding + self-block.</li></ul><h2 id="config-sync" tabindex="-1">Config + sync <a class="header-anchor" href="#config-sync" aria-label="Permalink to &quot;Config + sync&quot;">​</a></h2><ul><li>Config store (local SQLite): stores key/value config in <code>config.db</code> for sync.</li><li>Cloud config sync: bi-directional sync between <code>ConfigStore</code> and Firestore.</li><li>Config poller: applies config flags to policies, apps, network, and settings.</li><li>Initial config snapshot: writes <code>snapshot.initial_payload</code> once after setup.</li></ul><h2 id="app-state-sync" tabindex="-1">App state sync <a class="header-anchor" href="#app-state-sync" aria-label="Permalink to &quot;App state sync&quot;">​</a></h2><ul><li>App snapshot storage: mirrors per-app policy state to <code>devices/{deviceId}/apps/{package}</code>.</li><li>App remote watcher: applies per-app policy changes and tracks portal-enforced hide/suspend lists.</li><li>App inventory uploader: uploads installed app list + icons to Firestore.</li></ul><h2 id="network-vpn-internals" tabindex="-1">Network + VPN internals <a class="header-anchor" href="#network-vpn-internals" aria-label="Permalink to &quot;Network + VPN internals&quot;">​</a></h2><ul><li>Host file auto-refresh: daily host file update job with progress notifications.</li><li>VPN watchdog keepalive: pings DNS path and restarts VPN on timeout.</li><li>Chrome SafeSearch enforcement: forces SafeSearch and disables Chrome DoH/QUIC.</li><li>VPN2 WireGuard watcher: premium WireGuard + CA install + lockdown.</li><li>Server stack details for VPN2/MITM: <code>vpn-wireguard</code>.</li></ul><h2 id="accessibility-helpers" tabindex="-1">Accessibility helpers <a class="header-anchor" href="#accessibility-helpers" aria-label="Permalink to &quot;Accessibility helpers&quot;">​</a></h2><ul><li>Accessibility auto-enable: re-enables the accessibility service via Settings.Secure.</li><li>Accessibility settings self-block: blocks disabling the accessibility service in Settings.</li><li>Screen capture dialog auto-accept: auto-clicks MediaProjection consent.</li><li>Gboard GIF search blocker: exits the GIF/search pane when enabled.</li><li>Accessibility screenshot capturer: exists but unused.</li></ul><h2 id="remote-control-reporting" tabindex="-1">Remote control + reporting <a class="header-anchor" href="#remote-control-reporting" aria-label="Permalink to &quot;Remote control + reporting&quot;">​</a></h2><ul><li>Remote command receiver: executes admin commands (lock/wipe/sync/uninstall/remote).</li><li>Remote support: WebRTC screen share + remote input via accessibility.</li><li>Report portal share: share a URL to open the local report portal.</li></ul><h2 id="updates-notifications" tabindex="-1">Updates + notifications <a class="header-anchor" href="#updates-notifications" aria-label="Permalink to &quot;Updates + notifications&quot;">​</a></h2><ul><li>Auto update checks: background APK checks and optional silent install.</li><li>Aurora device spoofing: builds and caches Play profile for Aurora auth.</li><li>Notification channels: defines service/update channel groups used by foreground services.</li></ul><h2 id="security" tabindex="-1">Security <a class="header-anchor" href="#security" aria-label="Permalink to &quot;Security&quot;">​</a></h2><ul><li>Remote uninstall flag: Firestore <code>pendingUninstall</code> triggers uninstall flow.</li><li>Blocked email uninstall: Firestore <code>bannedEmails/{email}</code> triggers uninstall flow.</li></ul>',42)])])}const b=i(s,[["render",o]]);export{h as __pageData,b as default};
