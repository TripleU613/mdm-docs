import{_ as a,c as t,o,ae as i}from"./chunks/framework.Cqi9LMMK.js";const h=JSON.parse('{"title":"Aurora updater","description":"","frontmatter":{},"headers":[],"relativePath":"android-app/updates/aurora-updater.md","filePath":"android-app/updates/aurora-updater.md"}'),l={name:"android-app/updates/aurora-updater.md"};function r(d,e,s,c,p,n){return o(),t("div",null,[...e[0]||(e[0]=[i('<h1 id="aurora-updater" tabindex="-1">Aurora updater <a class="header-anchor" href="#aurora-updater" aria-label="Permalink to &quot;Aurora updater&quot;">​</a></h1><h2 id="where-it-lives" tabindex="-1">Where it lives <a class="header-anchor" href="#where-it-lives" aria-label="Permalink to &quot;Where it lives&quot;">​</a></h2><ul><li><code>app/src/main/java/com/tripleu/ui/fragments/UpdatesFragment.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/UpdatesViewModel.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/AuroraUpdateRepository.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/AuroraUpdateInstallManager.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/AuroraUpdateInstallReceiver.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/UpdateItem.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/InstalledApp.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/DeliveryFile.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/UpdateInstallState.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/PlayAuthStore.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/PlayHttpClient.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/IProxyHttpClient.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/ProxyInfo.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/EglExtensionProvider.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/PlayDeviceSpoofManager.kt</code></li><li><code>app/src/main/java/com/tripleu/updates/UpdatesMuteStore.kt</code></li></ul><h2 id="what-it-does" tabindex="-1">What it does <a class="header-anchor" href="#what-it-does" aria-label="Permalink to &quot;What it does&quot;">​</a></h2><ul><li>Lists available app updates using the Aurora GPlay API.</li><li>Pull to refresh, search by name/package, update one or all.</li><li>Expand a card to see version change, size, and changelog.</li><li>Swipe to mute an update (hides it from the list).</li></ul><h2 id="requirements" tabindex="-1">Requirements <a class="header-anchor" href="#requirements" aria-label="Permalink to &quot;Requirements&quot;">​</a></h2><ul><li>Android 9 (P) or higher.</li><li>Device owner required for silent installs.</li></ul><h2 id="how-it-runs" tabindex="-1">How it runs <a class="header-anchor" href="#how-it-runs" aria-label="Permalink to &quot;How it runs&quot;">​</a></h2><ul><li><code>UpdatesViewModel.refresh()</code> builds the installed app list and calls <code>AuroraUpdateRepository.fetchAvailableUpdates(...)</code>.</li><li>Repository uses Aurora <code>AppDetailsHelper</code> with cached auth from <code>PlayAuthStore</code>.</li><li>Auth comes from <code>https://auroraoss.com/api/auth</code> and refreshes about every hour or when invalid.</li><li>Updates are kept only if <code>versionCode</code> is newer than what&#39;s installed.</li><li><code>UpdatesMuteStore</code> filters muted packages and writes <code>updates.muted_packages</code> to <code>ConfigStore</code>.</li><li>&quot;Update All&quot; only includes apps that are not already queued or installing.</li><li><code>UpdateItem</code> holds the update card data, and <code>InstalledApp</code> holds the installed snapshot.</li><li><code>PlayHttpClient</code> implements <code>IProxyHttpClient</code> (proxy hook exists but is not called in app code).</li></ul><h2 id="install-flow" tabindex="-1">Install flow <a class="header-anchor" href="#install-flow" aria-label="Permalink to &quot;Install flow&quot;">​</a></h2><ul><li>Tap Update adds the item to a queue (<code>UpdateStatus.QUEUED</code>), processed one-by-one.</li><li><code>resolveDownloadInfo()</code> uses Aurora <code>PurchaseHelper</code> to fetch base/split download URLs.</li><li><code>AuroraUpdateInstallManager</code> downloads slices to cache and installs via <code>PackageInstaller.Session</code>.</li><li>If <code>DISALLOW_INSTALL_APPS</code> is active, it is temporarily disabled for the install and restored after ~3s.</li><li><code>DeliveryFile</code> entries are used to install split APKs when provided.</li><li><code>AuroraUpdateInstallReceiver</code> emits an internal broadcast with install results and extras.</li></ul><h2 id="state-and-progress" tabindex="-1">State and progress <a class="header-anchor" href="#state-and-progress" aria-label="Permalink to &quot;State and progress&quot;">​</a></h2><ul><li>Status: <code>IDLE</code>, <code>QUEUED</code>, <code>DOWNLOADING</code>, <code>INSTALLING</code>, <code>SUCCESS</code>, <code>FAILED</code>.</li><li>Progress appears on the action button and icon ring.</li><li><code>UpdateInstallState</code> tracks status + progress per package.</li></ul>',13)])])}const m=a(l,[["render",r]]);export{h as __pageData,m as default};
