import{_ as i,c as a,o as t,ae as o}from"./chunks/framework.Cqi9LMMK.js";const u=JSON.parse('{"title":"Enable private DNS","description":"","frontmatter":{},"headers":[],"relativePath":"android-app/network/enable-private-dns.md","filePath":"android-app/network/enable-private-dns.md"}'),r={name:"android-app/network/enable-private-dns.md"};function l(n,e,d,s,c,h){return t(),a("div",null,[...e[0]||(e[0]=[o('<h1 id="enable-private-dns" tabindex="-1">Enable private DNS <a class="header-anchor" href="#enable-private-dns" aria-label="Permalink to &quot;Enable private DNS&quot;">​</a></h1><h2 id="where-it-lives" tabindex="-1">Where it lives <a class="header-anchor" href="#where-it-lives" aria-label="Permalink to &quot;Where it lives&quot;">​</a></h2><ul><li><code>app/src/main/java/com/tripleu/ui/fragments/PrivacyFragment.kt</code></li><li><code>app/src/main/java/com/tripleu/ui/fragments/PrivacyDialogState.kt</code></li><li><code>app/src/main/java/com/tripleu/config/ConfigPoller.kt</code></li></ul><h2 id="what-it-does" tabindex="-1">What it does <a class="header-anchor" href="#what-it-does" aria-label="Permalink to &quot;What it does&quot;">​</a></h2><ul><li>Sets Android Private DNS mode to a hostname.</li><li>Defaults to <code>all.dns.mullvad.net</code> when the input is empty.</li><li>Locks the setting with <code>UserManager.DISALLOW_CONFIG_PRIVATE_DNS</code>.</li><li>Stores <code>network.private_dns_enabled</code> and <code>network.private_dns_hostname</code> in <code>ConfigStore</code>.</li></ul><h2 id="requirements" tabindex="-1">Requirements <a class="header-anchor" href="#requirements" aria-label="Permalink to &quot;Requirements&quot;">​</a></h2><ul><li>Android 10+ (Q).</li><li><code>WRITE_SECURE_SETTINGS</code> permission.</li></ul><h2 id="how-it-runs" tabindex="-1">How it runs <a class="header-anchor" href="#how-it-runs" aria-label="Permalink to &quot;How it runs&quot;">​</a></h2><ul><li>Toggle on opens the DNS dialog and calls <code>applyCustomDns(...)</code>: <ul><li>Writes <code>Settings.Global</code> <code>private_dns_mode=hostname</code> and <code>private_dns_specifier</code>.</li><li>Stores <code>private_dns_set</code> + <code>custom_dns_server</code> in prefs and <code>Hawk.isPrivateDnsChecked</code>.</li><li>Locks the Private DNS setting.</li><li>Triggers <code>AdVpnService</code> refresh after ~3s if VPN is running.</li></ul></li><li>Toggle off clears the <code>Settings.Global</code> keys and removes the restriction + stored values.</li><li>When whitelist mode is enabled, private DNS is forced off and the toggle is disabled.</li><li><code>AdVpnThread</code> skips DNS interception while Private DNS is on, unless whitelist mode is active.</li></ul>',9)])])}const m=i(r,[["render",l]]);export{u as __pageData,m as default};
