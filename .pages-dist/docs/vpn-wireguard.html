<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VPN + proxies (WireGuard) | TripleUMDM Docs</title>
    <meta name="description" content="Internal system docs">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/docs/assets/style.DuOwLuGy.css" as="style">
    <link rel="preload stylesheet" href="/docs/vp-icons.css" as="style">
    
    <script type="module" src="/docs/assets/app.o-vSBVwn.js"></script>
    <link rel="preload" href="/docs/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/docs/assets/chunks/theme.zyXmtp-E.js">
    <link rel="modulepreload" href="/docs/assets/chunks/framework.Cqi9LMMK.js">
    <link rel="modulepreload" href="/docs/assets/vpn-wireguard.md.BcYlUgyT.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/docs/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>TripleUMDM Docs</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/docs/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/docs/android-app/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Android MDM app</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/docs/website.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Website TS</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/docs/firestore-config.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Firestore config DB</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/docs/vpn-wireguard.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>VPN + MITM proxy</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/docs/directus.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Directus DB</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b3fd67f8><!----><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/docs/" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Home</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/docs/android-app/" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Android app</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/docs/website.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Website</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/docs/firestore-config.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Firestore config</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/docs/vpn-wireguard.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>VPN + MITM proxy</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/docs/directus.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Directus</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _docs_vpn-wireguard" data-v-39a288b8><div><h1 id="vpn-proxies-wireguard" tabindex="-1">VPN + proxies (WireGuard) <a class="header-anchor" href="#vpn-proxies-wireguard" aria-label="Permalink to &quot;VPN + proxies (WireGuard)&quot;">​</a></h1><p>Scope: Android app behavior plus kvylock server stack (WireGuard + MITM + Directus).</p><h2 id="connections" tabindex="-1">Connections <a class="header-anchor" href="#connections" aria-label="Permalink to &quot;Connections&quot;">​</a></h2><ul><li>Firebase control plane: <code>firestore-config</code>.</li><li>Website admin UI (VPN tab + appeals): <code>website</code>.</li><li>Directus schema + ops: <code>directus</code>.</li></ul><h2 id="traffic-paths-chrome-vs-rest" tabindex="-1">Traffic paths (Chrome vs rest) <a class="header-anchor" href="#traffic-paths-chrome-vs-rest" aria-label="Permalink to &quot;Traffic paths (Chrome vs rest)&quot;">​</a></h2><ul><li>Chrome uses an explicit proxy only when premium VPN is active: <ul><li>Proxy target: <code>http://10.9.0.1:8080</code>.</li><li>Enforced by Chrome app restrictions (SafeSearch + QUIC/DoH off).</li></ul></li><li>The proxy connection itself travels inside the WireGuard tunnel (Chrome still uses the VPN path).</li><li>All other apps stay inside the WireGuard tunnel and are not sent to the MITM proxy.</li><li>Squid is the domain/SNI blocker for VPN traffic: <ul><li>Deny-list only (no TLS decrypt).</li><li>Uses DNS/ipset + firewall rules to block domains.</li></ul></li><li>MITM proxy is for Chrome-only, explicit-proxy traffic.</li><li>Result: <ul><li>Chrome -&gt; WireGuard -&gt; MITM proxy -&gt; Internet.</li><li>Other apps -&gt; WireGuard -&gt; Squid/dnsmasq domain blocks -&gt; Internet.</li></ul></li></ul><h2 id="where-it-lives" tabindex="-1">Where it lives <a class="header-anchor" href="#where-it-lives" aria-label="Permalink to &quot;Where it lives&quot;">​</a></h2><ul><li><code>app/src/main/java/com/tripleu/vpn2/Vpn2RemoteWatcher.kt</code></li><li><code>app/src/main/java/com/tripleu/vpn2/Vpn2WireGuardManager.kt</code></li><li><code>app/src/main/java/com/tripleu/vpn2/Vpn2State.kt</code></li><li><code>app/src/main/java/com/tripleu/vpn/VpnPermissionHelper.kt</code></li><li><code>app/src/main/java/com/tripleu/TripleUApp.kt</code></li></ul><h2 id="when-it-runs" tabindex="-1">When it runs <a class="header-anchor" href="#when-it-runs" aria-label="Permalink to &quot;When it runs&quot;">​</a></h2><ul><li><code>Vpn2RemoteWatcher.start(...)</code> runs during deferred app startup and on boot.</li><li><code>PeriodicTaskRunner</code> calls <code>Vpn2RemoteWatcher.tick()</code> every ~5s.</li><li>It attaches a Firestore listener on <code>devices/{deviceId}</code> and also applies on each tick.</li></ul><h2 id="gating-must-be-true" tabindex="-1">Gating (must be true) <a class="header-anchor" href="#gating-must-be-true" aria-label="Permalink to &quot;Gating (must be true)&quot;">​</a></h2><ul><li><code>ConfigStore</code> flag <code>network.premium_vpn_enabled=true</code>.</li><li><code>devices/{deviceId}.vpn</code> contains: <ul><li><code>active=true</code></li><li><code>stripeSubscriptionId</code> not empty</li><li><code>expiresAtMs</code> in the future</li><li><code>wgAddress</code>, <code>wgPort</code>, <code>wgServerPublicKey</code> present</li></ul></li><li>If any gate fails, WireGuard is stopped (or never started) and Always-On lockdown is cleared.</li></ul><h2 id="firestore-fields-used-written" tabindex="-1">Firestore fields used/written <a class="header-anchor" href="#firestore-fields-used-written" aria-label="Permalink to &quot;Firestore fields used/written&quot;">​</a></h2><ul><li>Read from <code>devices/{deviceId}.vpn</code>: <ul><li><code>active</code>, <code>expiresAtMs</code>, <code>stripeSubscriptionId</code></li><li><code>wgAddress</code>, <code>wgPort</code>, <code>wgServerPublicKey</code></li><li><code>wgEndpoint</code> (optional; default <code>vpn.kvylock.com</code>)</li><li><code>wgDns</code> (optional)</li><li><code>wgPublicKey</code> (optional)</li></ul></li><li>Write: <ul><li><code>vpn.wgPublicKey</code> (uploaded when missing or outdated).</li></ul></li></ul><h2 id="key-handling" tabindex="-1">Key handling <a class="header-anchor" href="#key-handling" aria-label="Permalink to &quot;Key handling&quot;">​</a></h2><ul><li>Generates a WireGuard keypair locally.</li><li>Stores the private key in prefs <code>vpn2_state.wg_private_key</code>.</li><li>Uploads the public key to Firestore for provisioning.</li></ul><h2 id="vpn-permission-lockdown" tabindex="-1">VPN permission + lockdown <a class="header-anchor" href="#vpn-permission-lockdown" aria-label="Permalink to &quot;VPN permission + lockdown&quot;">​</a></h2><ul><li>Uses <code>VpnPermissionHelper.ensureVpnPermission(..., enableIntent=true, lockdown=true)</code>.</li><li>If VPN consent is not already granted, WireGuard does not start.</li><li>When active, it sets Always-On VPN with lockdown via DPM.</li></ul><h2 id="tunnel-config" tabindex="-1">Tunnel config <a class="header-anchor" href="#tunnel-config" aria-label="Permalink to &quot;Tunnel config&quot;">​</a></h2><ul><li>Uses WireGuard GoBackend.</li><li>Interface: <ul><li>address <code>wgAddress/32</code></li><li>DNS from <code>wgDns</code>, or derived from address (x.x.x.1).</li></ul></li><li>Peer: <ul><li>endpoint <code>${wgEndpoint}:${wgPort}</code></li><li>server public key <code>wgServerPublicKey</code></li><li>allowed IPs <code>0.0.0.0/0, ::/0</code>.</li></ul></li></ul><h2 id="blocked-apps-interaction" tabindex="-1">Blocked apps interaction <a class="header-anchor" href="#blocked-apps-interaction" aria-label="Permalink to &quot;Blocked apps interaction&quot;">​</a></h2><ul><li>Reads prefs <code>firewall_rules</code> and passes those packages as excluded apps.</li><li>Excluded apps bypass the WireGuard tunnel (confirm desired behavior for premium VPN).</li></ul><h2 id="legacy-vpn-interaction" tabindex="-1">Legacy VPN interaction <a class="header-anchor" href="#legacy-vpn-interaction" aria-label="Permalink to &quot;Legacy VPN interaction&quot;">​</a></h2><ul><li><code>Vpn2State.shouldBlockLegacy(...)</code> is true when premium is enabled or active.</li><li>The watcher stops <code>AdVpnService</code> and <code>WhitelistVpnService</code> before starting WireGuard.</li><li>Legacy VPN toggles are skipped while premium is active.</li></ul><h2 id="mitm-ca-install-app-side" tabindex="-1">MITM CA install (app side) <a class="header-anchor" href="#mitm-ca-install-app-side" aria-label="Permalink to &quot;MITM CA install (app side)&quot;">​</a></h2><ul><li>If device owner, installs CA certs from assets: <ul><li><code>app/src/main/assets/kvylock.pem</code></li><li><code>app/src/main/assets/mitmproxy-ca.pem</code></li></ul></li><li>Stores SHA-256 fingerprints in <code>vpn2_state</code> to avoid re-installing.</li></ul><h2 id="server-kvylock" tabindex="-1">Server (kvylock) <a class="header-anchor" href="#server-kvylock" aria-label="Permalink to &quot;Server (kvylock)&quot;">​</a></h2><h3 id="core-services" tabindex="-1">Core services <a class="header-anchor" href="#core-services" aria-label="Permalink to &quot;Core services&quot;">​</a></h3><ul><li>WireGuard: <code>wg-quick@wg-mitm</code> with config <code>/etc/wireguard/wg-mitm.conf</code>.</li><li>VPN API: <code>api-http.service</code> runs <code>/opt/api/server.py</code> on <code>127.0.0.1:8000</code>.</li><li>Squid: <code>squid.service</code> provides the VPN intercept proxy on <code>3128/3129</code>.</li><li>MITM proxy: <code>mitmproxy.service</code> runs <code>mitmweb</code> in explicit mode on <code>:8080</code> with web UI on <code>127.0.0.1:8081</code>.</li><li>DNS: <code>dnsmasq</code> listens on <code>0.0.0.0:5353</code> for VPN clients.</li><li>Directus: Docker <code>directus</code> + <code>directus-postgres</code>, proxied by Nginx.</li><li>Nginx: TLS entrypoint for <code>vpn.kvylock.com</code>.</li></ul><h3 id="admin-uis" tabindex="-1">Admin UIs <a class="header-anchor" href="#admin-uis" aria-label="Permalink to &quot;Admin UIs&quot;">​</a></h3><ul><li><code>https://vpn.kvylock.com/logs/</code>: MITM proxy web UI (basic auth).</li><li><code>https://vpn.kvylock.com/squid/</code>: Squid GoAccess report (basic auth).</li><li><code>https://vpn.kvylock.com/live/</code>: Live MITM log viewer (basic auth). <ul><li>Shows live allow/deny/unknown markers and collapses repeated domains with a counter.</li></ul></li></ul><h3 id="wireguard-config-keys" tabindex="-1">WireGuard config + keys <a class="header-anchor" href="#wireguard-config-keys" aria-label="Permalink to &quot;WireGuard config + keys&quot;">​</a></h3><ul><li>Interface: <code>wg-mitm</code> address <code>10.9.0.1/24</code>, listen port <code>51820</code>.</li><li>Peer blocks are annotated with <code># device:&lt;id&gt;</code> and <code>AllowedIPs = &lt;ip&gt;/32</code>.</li><li>Keys live in <code>/etc/wireguard/keys</code> (<code>wg-mitm.key</code>, <code>wg-mitm.pub</code>, plus <code>wg-clean</code>/<code>wg-block</code>).</li><li>Only <code>wg-mitm.conf</code> exists on the server (no <code>wg-clean</code>/<code>wg-block</code> configs present).</li><li>Service state: <code>wg-quick@wg-mitm</code> is enabled; <code>wg show</code> lists peers and handshakes.</li><li>Provisioning sync uses <code>wg-quick up</code> to ensure the interface, then <code>wg-quick strip</code> + <code>wg syncconf</code>.</li><li><code>SaveConfig</code> is <code>false</code> in <code>wg-mitm.conf</code>, so file edits are authoritative.</li></ul><h3 id="vpn-api-provisioning" tabindex="-1">VPN API (provisioning) <a class="header-anchor" href="#vpn-api-provisioning" aria-label="Permalink to &quot;VPN API (provisioning)&quot;">​</a></h3><ul><li>Nginx route: <code>https://vpn.kvylock.com/api</code> -&gt; <code>127.0.0.1:8000</code>.</li><li>Auth: expects <code>x-api-key</code> matching <code>API_KEY</code> in <code>/opt/api/api.env</code>.</li><li>Tasks: <ul><li><code>wg_upsert</code> writes a <code># device:&lt;id&gt;</code> block into <code>wg-mitm.conf</code>, then <code>wg syncconf</code>.</li><li><code>wg_remove</code> removes the block and syncs the interface.</li></ul></li><li>Endpoints: <ul><li><code>GET /</code> returns <code>status: ok</code> without auth.</li><li><code>POST /</code> requires auth and JSON body.</li></ul></li><li>Request fields: <ul><li><code>task</code> is <code>wg_upsert</code> or <code>wg_remove</code>.</li><li><code>id</code> is required for both tasks.</li><li><code>publicKey</code> and <code>address</code> are required for <code>wg_upsert</code>.</li><li><code>mode</code> defaults to <code>mitm</code> (only <code>mitm</code> is configured).</li></ul></li><li>Responses are JSON with <code>status</code> (<code>success</code> or <code>failure</code>) and an <code>error</code> string on failure.</li><li>Logs: <code>/opt/api/log.txt</code>.</li></ul><h3 id="squid-proxy-intercept" tabindex="-1">Squid proxy (intercept) <a class="header-anchor" href="#squid-proxy-intercept" aria-label="Permalink to &quot;Squid proxy (intercept)&quot;">​</a></h3><ul><li>Config: <ul><li><code>/etc/squid/squid.conf</code> (<code>http_port 3128 intercept</code>).</li><li><code>/etc/squid/conf.d/tripleu-mdm.conf</code> (allow <code>10.9.0.0/24</code>).</li><li><code>/etc/squid/conf.d/tripleu-ssl.conf</code> (TLS intercept + ssl-bump).</li><li><code>/etc/squid/conf.d/goaccess.conf</code> (GoAccess log format).</li><li><code>/etc/squid/conf.d/tripleu-host-verify.conf</code> (<code>host_verify_strict off</code> to avoid SNI/IP mismatch blocks).</li><li><code>/etc/squid/conf.d/tripleu-dns.conf</code> (forces DNS to <code>1.1.1.1/1.0.0.1</code> to match client resolution).</li></ul></li><li>Blocklist: <ul><li>Per-list files (HTTP URL regex + HTTPS domains): <ul><li><code>/etc/squid/blocklists/maps-urls.txt</code> + <code>/etc/squid/blocklists/maps-domains.txt</code></li><li><code>/etc/squid/blocklists/gifs-urls.txt</code> + <code>/etc/squid/blocklists/gifs-domains.txt</code></li><li><code>/etc/squid/blocklists/adblock-urls.txt</code> + <code>/etc/squid/blocklists/adblock-domains.txt</code></li><li><code>/etc/squid/blocklists/general-urls.txt</code> + <code>/etc/squid/blocklists/general-domains.txt</code></li><li><code>/etc/squid/blocklists/app_urls-urls.txt</code> + <code>/etc/squid/blocklists/app_urls-domains.txt</code></li></ul></li><li>Behavior: deny only; everything else is allowed.</li><li>Source: <ul><li>Directus collections <code>maps</code>, <code>gifs</code>, <code>squid-general_block</code> (field <code>url</code>).</li><li><code>app_urls</code> (field <code>urls</code>).</li><li>Any Directus collection in the <code>apps</code> group (one list per collection; uses <code>url</code> or <code>urls</code>).</li></ul></li><li>Per-device toggles: Directus <code>vpn_squid_prefs</code> (default enabled; only disabled lists are stored).</li><li>Device mapping: <code>/etc/wireguard/wg-mitm.conf</code> uses <code># device:&lt;id&gt;</code> comments with <code>AllowedIPs</code> for IP rules.</li><li>Sync: <code>squid-blocklist-sync.timer</code> (runs every 30 seconds).</li><li>Expect up to ~30s for new entries/toggles to take effect; removals can lag due to ipset TTL.</li><li>Sync script: <code>/opt/squid-blocklist/sync.py</code> (auth uses Directus admin in <code>/opt/directus/.env</code>).</li><li>Ad Block source: <code>/opt/squid-blocklist/lists/oisd-full.txt</code> (OISD Full), synced daily by <code>oisd-sync.timer</code>.</li><li><code>maps</code> is informational only (no per-app routing); entries are enforced per-device.</li><li>Entry rules: <ul><li><code>example.com</code> -&gt; domain block (SNI/dstdomain).</li><li><code>||example.com^</code> -&gt; domain block (Adblock-style).</li><li><code>0.0.0.0 example.com</code> -&gt; domain block (hosts-file style).</li><li><code>http://example.com/path</code> or <code>example.com/path</code> -&gt; HTTP URL block only.</li><li>HTTPS URL paths cannot be blocked without MITM; only the domain is used.</li></ul></li><li>Squid ACLs (generated): <code>/etc/squid/conf.d/10-tripleu-device-blocklists.conf</code>.</li><li>DNS/ipset: <ul><li><code>/etc/dnsmasq.d/squid-blocklist.conf</code> maps domains into ipsets.</li><li>ipsets per list: <code>squid_maps</code>, <code>squid_gifs</code>, <code>squid_adblock</code>, <code>squid_general</code>, <code>squid_app_urls</code> (+ <code>*6</code> for IPv6).</li><li>ipset entries expire after 86400s (set by <code>SQUID_IPSET_TIMEOUT</code>); removals can take up to the timeout.</li><li>HTTPS blocks are enforced in iptables per device using the list ipsets (no Squid intercept).</li><li><code>squid-ipset.service</code> ensures the ipsets exist at boot.</li></ul></li></ul></li><li>Ports: <ul><li><code>3128</code> HTTP intercept.</li><li><code>3129</code> HTTPS intercept (<code>ssl-bump</code> + generated certs).</li><li><code>127.0.0.1:3127</code> local forward-proxy port (needed by Squid for bumping).</li></ul></li><li>TLS behavior: <ul><li><code>ssl_bump peek step1</code>, then <code>splice all</code> (no decrypt).</li></ul></li><li>Certs: <ul><li>CA cert/key: <code>/etc/squid/ssl_cert/squid-ca.pem</code>.</li><li>SSL DB: <code>/var/lib/squid/ssl_db</code>.</li></ul></li><li>Logs: <ul><li>GoAccess log file: <code>/var/log/squid/access-goaccess.log</code>.</li></ul></li><li>Log UI (GoAccess): <ul><li>Service: <code>goaccess-squid.service</code>.</li><li>Output: <code>/opt/goaccess/squid.html</code>.</li><li>WebSocket: <code>127.0.0.1:8090</code> (proxied at <code>/squid/ws</code>).</li></ul></li><li>URL: <code>https://vpn.kvylock.com/squid/</code> (basic auth; same as <code>/logs</code>).</li></ul><h3 id="mitm-proxy" tabindex="-1">MITM proxy <a class="header-anchor" href="#mitm-proxy" aria-label="Permalink to &quot;MITM proxy&quot;">​</a></h3><ul><li>Explicit proxy on <code>0.0.0.0:8080</code> (clients must point to it).</li><li>Input is limited to WireGuard clients (<code>10.9.0.0/24</code>).</li><li>Web UI: <code>https://vpn.kvylock.com/logs/</code> -&gt; <code>127.0.0.1:8081</code> (Nginx basic auth).</li><li>Certs: <code>/opt/mitmproxy/certs/mitmproxy-ca.pem</code> and <code>mitmproxy-dhparam.pem</code>.</li><li>Runner: <code>/opt/blockers/runner.py</code> loads the blocker modules below.</li><li>Version: mitmproxy 12.2.0 in <code>/opt/mitmproxy-venv</code>.</li><li>Directus defaults: blockers use <code>http://127.0.0.1:8055</code> and read <code>/opt/directus/.env</code> when <code>DIRECTUS_TOKEN</code> is not set.</li><li>Service flags: <code>--mode regular</code>, <code>--showhost</code>, <code>--set confdir=/opt/mitmproxy/certs/</code>, <code>--set web_password=...</code>.</li><li>SNI logging: <code>SNI_LOG_IPS=*</code> and <code>SNI_LOG_TTL=30</code> are set on the service.</li></ul><h4 id="blocker-modules" tabindex="-1">Blocker modules <a class="header-anchor" href="#blocker-modules" aria-label="Permalink to &quot;Blocker modules&quot;">​</a></h4><ul><li>Policy core: <code>/opt/blockers/policy.py</code>. <ul><li>Pulls <code>website_categories</code>, <code>websites</code>, <code>bad_words</code> from Directus.</li><li>Caches rule sets for <code>WEBSITES_TTL</code> seconds.</li><li>Maps WireGuard client IP to <code>device:&lt;id&gt;</code> by parsing <code>wg-mitm.conf</code>.</li><li>Per-device cache for <code>vpn_category_prefs</code> and <code>vpn_site_overrides</code> for <code>DEVICE_POLICY_TTL</code> seconds.</li><li>WireGuard config path can be overridden by <code>WG_CONFIG_PATH</code>.</li><li>Match types: <code>contains</code>, <code>startswith</code>, <code>endswith</code>, <code>exact</code>, <code>wildcard</code>.</li><li>Visibility <code>report</code>, <code>extreme</code>, <code>security</code> forces block regardless of category prefs.</li><li>Site overrides can force allow or force block, and override image or word policy.</li><li>Rule evaluation checks blocked rules first, then allowed rules, otherwise status is unknown.</li><li>Category defaults are applied when no per-device prefs exist.</li><li>Word filtering replaces matched terms with asterisks in text responses.</li></ul></li><li>Website rules: <code>/opt/blockers/website-blocker/blocker.py</code>. <ul><li>Uses Directus <code>website_categories</code>, <code>websites</code>, <code>bad_words</code>.</li><li>Blocked pages show a local appeal portal at <code>/.kvylock/appeal</code>.</li><li>Appeals write to Directus <code>website_appeals</code> and <code>vpn_appeals</code>.</li><li>Word filter masks text in HTML/JS/JSON responses.</li><li>Portal links use <code>PORTAL_HOST</code> when set, otherwise relative paths.</li><li>Category lists are built from <code>visibility</code> and sorted by <code>sort_order</code>.</li><li>Categories list refresh uses <code>APPEAL_CATEGORIES_TTL</code>.</li><li>Unknown sites return a 451 page with &quot;Request Review&quot;.</li><li>Blocked sites return a 451 page with &quot;Appeal Access&quot;.</li><li>Non-HTML blocked requests are killed.</li><li>Portal modes: <code>appeal</code>, <code>review</code>, <code>report</code>.</li><li>Portal POSTs capture <code>url</code>, <code>host</code>, <code>reason</code>, and <code>device_id</code> when available.</li><li>Uses a hardcoded category list if Directus returns none.</li></ul></li><li>Image filter: <code>/opt/blockers/image-blocker/intercept.py</code>. <ul><li>If policy enables image blocking, replaces images with transparent PNGs.</li><li>Global ignore list: <code>/opt/blockers/image-blocker/glob-ingone-hosts.txt</code>.</li><li>Parses PNG, GIF, JPEG, WebP sizes to keep dimensions when possible.</li><li>If parse fails, uses a 1x1 transparent PNG.</li><li>Cache and parse limits are controlled by <code>IMAGE_BLOCKER_CACHE</code> and <code>IMAGE_BLOCKER_PARSE_LIMIT</code>.</li><li>Current ignore list includes <code>kvylock.com</code> and <code>tripleu.com</code>.</li></ul></li><li>Search filter: <code>/opt/blockers/search-blocker/blocker.py</code>. <ul><li>Blocks searches matching <code>bad-words.txt</code>.</li><li>Enforces Google SafeSearch by adding <code>safe=active</code>.</li><li>Only triggers on search hosts and query keys like <code>q</code>, <code>query</code>, <code>search</code>.</li><li>This list is local and separate from Directus <code>bad_words</code>.</li></ul></li><li>SNI blocker: <code>/opt/blockers/sni-blocker/blocker.py</code>. <ul><li>Reads domains from Directus <code>mitm_block_domains.domain</code>.</li><li>Blocks at TLS/QUIC client hello (before MITM).</li><li>SNI logging is enabled in <code>mitmproxy.service</code> (<code>SNI_LOG_IPS=*</code>).</li><li>Sources can be overridden with <code>SNI_BLOCK_SOURCES</code>.</li><li>Cache TTL uses <code>SNI_BLOCK_TTL</code>.</li><li>Log throttling uses <code>SNI_LOG_TTL</code>.</li><li>Defaults to <code>mitm_block_domains:domain</code> when sources are not set.</li></ul></li><li>MITM ignore list: <code>/opt/blockers/mitm-ignore/blocker.py</code>. <ul><li>Pulls <code>mitm_ignore_domains.domain</code> and merges into <code>ignore_hosts</code>.</li><li>Resolves IPs unless <code>MITM_IGNORE_RESOLVE</code> is disabled.</li><li>Cache TTL uses <code>MITM_IGNORE_TTL</code>.</li></ul></li></ul><h3 id="blocker-environment-knobs" tabindex="-1">Blocker environment knobs <a class="header-anchor" href="#blocker-environment-knobs" aria-label="Permalink to &quot;Blocker environment knobs&quot;">​</a></h3><ul><li><code>DIRECTUS_URL</code>, <code>DIRECTUS_ENV</code>, <code>DIRECTUS_TOKEN</code> (shared across blockers).</li><li><code>WEBSITES_TTL</code>, <code>DEVICE_POLICY_TTL</code>, <code>WG_CONFIG_PATH</code> (policy core).</li><li><code>APPEAL_CATEGORIES_TTL</code>, <code>PORTAL_HOST</code> (portal behavior).</li><li><code>SNI_BLOCK_TTL</code>, <code>SNI_BLOCK_SOURCES</code>, <code>SNI_BLOCK_COLLECTION</code>, <code>SNI_BLOCK_FIELD</code>, <code>SNI_LOG_IPS</code>, <code>SNI_LOG_TTL</code> (SNI blocker).</li><li><code>MITM_IGNORE_TTL</code>, <code>MITM_IGNORE_RESOLVE</code> (MITM ignore list).</li><li><code>IMAGE_BLOCKER_CACHE</code>, <code>IMAGE_BLOCKER_PARSE_LIMIT</code> (image blocker).</li></ul><h3 id="mitm-portal-ux-flow" tabindex="-1">MITM portal UX flow <a class="header-anchor" href="#mitm-portal-ux-flow" aria-label="Permalink to &quot;MITM portal UX flow&quot;">​</a></h3><ul><li>Path: <code>/.kvylock/appeal</code> served by the MITM proxy.</li><li>Entry points: <ul><li>Unknown site: 451 &quot;Site Not Reviewed&quot; page with &quot;Request Review&quot;.</li><li>Blocked site: 451 &quot;Site Blocked&quot; page with &quot;Appeal Access&quot;.</li></ul></li><li>GET parameters: <code>url</code>, <code>host</code>, <code>mode</code>, optional <code>category_id</code>.</li><li>Modes: <ul><li><code>appeal</code>: access request (default).</li><li><code>review</code>: request a category for an unknown site.</li><li><code>report</code>: report a site that should be blocked.</li></ul></li><li>Form fields: hidden <code>url</code>, <code>host</code>, <code>mode</code>, optional <code>category_id</code>, optional <code>reason</code>.</li><li>Category lists: <ul><li>Uses Directus categories by <code>visibility</code> (<code>public</code>, <code>more</code>, <code>report</code>).</li><li>Falls back to a hardcoded list when Directus returns none.</li></ul></li><li>POST behavior: <ul><li><code>review</code> and <code>report</code> require a category selection; missing category returns a 400 result page.</li><li><code>appeal</code> writes to <code>vpn_appeals</code> (includes <code>device_id</code> when a WG IP maps to a device).</li><li><code>review</code> and <code>report</code> write to <code>website_appeals</code>.</li></ul></li><li>Success and error both return a simple HTML result page.</li></ul><h3 id="portal-html-templates-copy-layout" tabindex="-1">Portal HTML templates (copy + layout) <a class="header-anchor" href="#portal-html-templates-copy-layout" aria-label="Permalink to &quot;Portal HTML templates (copy + layout)&quot;">​</a></h3><ul><li>Shared layout: <ul><li>Single centered card on a light gray background.</li><li>Heading, short description, and a URL display block.</li><li>Buttons are blue with white text.</li></ul></li><li>&quot;Site Not Reviewed&quot; block page: <ul><li>Title: &quot;Site Not Reviewed&quot;.</li><li>Message: &quot;This website has not been reviewed yet.&quot;</li><li>Action: &quot;Request Review&quot; button.</li></ul></li><li>&quot;Site Blocked&quot; block page: <ul><li>Title: &quot;Site Blocked&quot;.</li><li>Message: &quot;This website is blocked because it is in the category name shown by policy.&quot;</li><li>Action: &quot;Appeal Access&quot; button.</li></ul></li><li>Appeal form page (mode switch): <ul><li><code>appeal</code>: title &quot;Appeal Access&quot;, description &quot;Request access to this website.&quot;</li><li><code>review</code>: title &quot;Request Review&quot;, description &quot;Suggest a category for this website.&quot;</li><li><code>report</code>: title &quot;Report Website&quot;, description &quot;Report a website you believe should be blocked.&quot;</li><li>Category dropdown label: &quot;Select a category&quot;.</li><li>Reason label: &quot;Reason (optional)&quot;.</li><li>Reason placeholder: &quot;Tell us why this site should be allowed...&quot;</li><li>Submit button: &quot;Submit&quot;.</li></ul></li><li>Result page: <ul><li>Title is &quot;Submitted&quot; or &quot;Error&quot;.</li><li>Message uses the server response text.</li></ul></li></ul><h3 id="dns-firewall" tabindex="-1">DNS + firewall <a class="header-anchor" href="#dns-firewall" aria-label="Permalink to &quot;DNS + firewall&quot;">​</a></h3><ul><li>HTTP redirect: iptables sends TCP 80 -&gt; <code>3128</code> for <code>10.9.0.0/24</code>.</li><li>HTTPS blocklist: iptables chain <code>SQUID_BLOCKLISTS</code> rejects TCP 443 per device when destination matches list ipsets.</li><li>DNS redirect: iptables sends TCP/UDP 53 from <code>10.9.0.0/24</code> to <code>:5353</code>.</li><li>DNS upstream: <code>dnsmasq</code> uses <code>1.1.1.1</code> and <code>1.0.0.1</code> (<code>/etc/dnsmasq.d/kvylock-safesearch.conf</code>).</li><li>Port <code>5353</code> is only accepted from <code>10.9.0.0/24</code> and localhost; other sources are dropped.</li><li>SafeSearch override list is empty in the current dnsmasq config file.</li><li>DoT blocked: iptables drops TCP/UDP 853 for <code>10.9.0.0/24</code>.</li><li>UDP 443 from VPN clients is rejected (QUIC block).</li><li>NAT: <code>10.9.0.0/24</code> is masqueraded out <code>eth0</code>.</li><li>iptables restore: <code>/etc/iptables/rules.v4</code> loaded by <code>iptables-restore.service</code> at boot.</li></ul><h3 id="traffic-path-current" tabindex="-1">Traffic path (current) <a class="header-anchor" href="#traffic-path-current" aria-label="Permalink to &quot;Traffic path (current)&quot;">​</a></h3><ul><li>VPN client connects to WireGuard <code>wg-mitm</code>.</li><li>TCP 80 is redirected to Squid (<code>3128</code>) for HTTP URL blocking.</li><li>TCP 443 goes direct unless the destination is in the Squid blocklist (then it is rejected).</li><li>Chrome (premium VPN active) uses explicit proxy <code>10.9.0.1:8080</code> to <code>mitmproxy</code>.</li><li>DNS requests hit <code>dnsmasq</code> on <code>:5353</code> before leaving the box.</li><li>QUIC and DNS-over-TLS are blocked to keep traffic on TCP and DNS on <code>dnsmasq</code>.</li></ul><h3 id="nginx-routes" tabindex="-1">Nginx routes <a class="header-anchor" href="#nginx-routes" aria-label="Permalink to &quot;Nginx routes&quot;">​</a></h3><ul><li><code>vpn.kvylock.com/api</code> -&gt; local VPN API.</li><li><code>vpn.kvylock.com/directus/</code> -&gt; local Directus (basic auth).</li><li><code>vpn.kvylock.com/logs/</code> -&gt; mitmweb UI (basic auth; adds an Authorization header in Nginx config).</li><li><code>vpn.kvylock.com/squid/</code> -&gt; Squid log UI (basic auth).</li><li>Basic auth file: <code>/etc/nginx/htpasswd-mitmweb</code> (user <code>tripleu</code>, PIN <code>Aa45301826</code>).</li></ul><h2 id="request-map-server-side" tabindex="-1">Request map (server side) <a class="header-anchor" href="#request-map-server-side" aria-label="Permalink to &quot;Request map (server side)&quot;">​</a></h2><ul><li>Firebase <code>onDeviceWrite</code> calls the VPN API to upsert WireGuard peers.</li><li>VPN API edits <code>wg-mitm.conf</code> and syncs the WireGuard interface.</li><li>MITM policy pulls Directus rules, categories, bad words, and device overrides.</li><li>MITM portal writes <code>vpn_appeals</code> and <code>website_appeals</code>.</li><li>Website writes Directus category prefs and site overrides.</li><li>Appeal approver promotes approved <code>website_appeals</code> into <code>websites</code>.</li><li>MITM maps WG client IPs back to <code>device:&lt;id&gt;</code> via <code>wg-mitm.conf</code>.</li></ul><h2 id="cross-system-flow-end-to-end" tabindex="-1">Cross-system flow (end-to-end) <a class="header-anchor" href="#cross-system-flow-end-to-end" aria-label="Permalink to &quot;Cross-system flow (end-to-end)&quot;">​</a></h2><ul><li>Android writes <code>vpn.wgPublicKey</code> and reads <code>devices/{deviceId}.vpn</code> for WG details.</li><li>Firebase functions allocate WG address/keys and call the kvylock VPN API.</li><li>VPN API updates WireGuard peers; MITM uses WG IP -&gt; device id mapping.</li><li>Website writes Directus category prefs and site overrides; MITM enforces them.</li></ul><h2 id="related-services-on-kvylock" tabindex="-1">Related services on kvylock <a class="header-anchor" href="#related-services-on-kvylock" aria-label="Permalink to &quot;Related services on kvylock&quot;">​</a></h2><h3 id="turn-remote-control" tabindex="-1">TURN (remote control) <a class="header-anchor" href="#turn-remote-control" aria-label="Permalink to &quot;TURN (remote control)&quot;">​</a></h3><ul><li>Service: <code>coturn.service</code> on <code>kvylock</code>.</li><li>Config: <code>/etc/turnserver.conf</code>.</li><li>Ports: <code>3478</code> (STUN/TURN) and <code>5349</code> (TLS).</li><li>Realm and external IP are set in the config; credentials use long-term auth.</li><li>Logs: <code>/var/log/turnserver.log</code> and <code>/var/tmp/turn_*.log</code>.</li><li>Used by the website Remote Control and by Firebase functions that return TURN config.</li></ul></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/docs/firestore-config.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>Firestore config</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/docs/directus.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>Directus</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"android-app_accessibility_android-auto-quirk.md\":\"SeK5bcqi\",\"android-app_accessibility_block-ai-chats.md\":\"U42nXXon\",\"android-app_accessibility_block-all-in-app-browsers.md\":\"YL1juMSo\",\"android-app_accessibility_block-default-browsers.md\":\"D_RavivG\",\"android-app_accessibility_block-status.md\":\"CmW_K--Z\",\"android-app_accessibility_block-whatsapp-channels.md\":\"KS698Cpe\",\"android-app_accessibility_block-whatsapp-updates-tab.md\":\"CivJtV6y\",\"android-app_accessibility_index.md\":\"CAn8HHjb\",\"android-app_apps_add-webview-exception.md\":\"B9AuDxHf\",\"android-app_apps_block-in-app-browser.md\":\"Cc3hNab_\",\"android-app_apps_block-uninstall.md\":\"8zxVmXZp\",\"android-app_apps_block-video.md\":\"B1W_sF2H\",\"android-app_apps_disable.md\":\"D_nCDahz\",\"android-app_apps_hide.md\":\"BzGKgu9b\",\"android-app_apps_index.md\":\"C7NCaY4b\",\"android-app_apps_make-offline.md\":\"D46VP2mp\",\"android-app_apps_make-suspended.md\":\"OqkvEGUD\",\"android-app_apps_managed-apps.md\":\"BqY5wn8x\",\"android-app_apps_system-apps.md\":\"BjuKGuqG\",\"android-app_apps_users-apps.md\":\"Cipy_--M\",\"android-app_home_app-update-prompt.md\":\"z35IkTO-\",\"android-app_home_did-you-know.md\":\"25SWeVGT\",\"android-app_home_hi.md\":\"bEgVywJp\",\"android-app_home_index.md\":\"ByRsqcaz\",\"android-app_home_managed-apps-overview.md\":\"L3TBwTBA\",\"android-app_home_policies-applied-counter.md\":\"DlXCjLj0\",\"android-app_home_policies-at-a-glance.md\":\"BZc3PsEU\",\"android-app_home_whitelist-summary-card.md\":\"BDlTus6r\",\"android-app_index.md\":\"CM8aQnsx\",\"android-app_installation_allow-user-updates.md\":\"C_Lm-Fpr\",\"android-app_installation_block-new-apps.md\":\"hxPdyQcT\",\"android-app_installation_block-play-store.md\":\"BsDeMLGC\",\"android-app_installation_disable-apk-install.md\":\"DwHyjsly\",\"android-app_installation_index.md\":\"DDgvpR6t\",\"android-app_invisible-features_accessibility-helpers.md\":\"CyYfJEWg\",\"android-app_invisible-features_app-state-sync.md\":\"B5h5Ak9W\",\"android-app_invisible-features_config-sync.md\":\"CZBbNP5r\",\"android-app_invisible-features_identity-admin.md\":\"Cf4I2s5R\",\"android-app_invisible-features_index.md\":\"Dgdw7cqW\",\"android-app_invisible-features_lifecycle-session.md\":\"CIOEEiw7\",\"android-app_invisible-features_network-vpn-internals.md\":\"8jPpVLyS\",\"android-app_invisible-features_remote-control-reporting.md\":\"thtZ4mR6\",\"android-app_invisible-features_security-integrity.md\":\"CPO1dAxi\",\"android-app_invisible-features_updates-notifications.md\":\"BZUoCDzA\",\"android-app_network_block-all-traffic.md\":\"U4QtnBYS\",\"android-app_network_block-wi-fi.md\":\"BtiQpQ5G\",\"android-app_network_disable-tethering-and-hotspot.md\":\"CwVB_lCQ\",\"android-app_network_enable-private-dns.md\":\"zo-WCClI\",\"android-app_network_enable-vpn-firewall-regular-vpn-not-vpn2.md\":\"CQiY_VoS\",\"android-app_network_index.md\":\"mVp8qhrE\",\"android-app_network_whitelist-domains-regular-vpn-not-vpn2.md\":\"DofVR53T\",\"android-app_onboarding_device-binding.md\":\"CTQA60FN\",\"android-app_onboarding_index.md\":\"jIkUWIII\",\"android-app_onboarding_mdm-pin-gate.md\":\"B-IAe9D6\",\"android-app_onboarding_onboarding-overview.md\":\"CCVuMXnk\",\"android-app_onboarding_password-reset.md\":\"AaF503hw\",\"android-app_onboarding_permissions-check.md\":\"BKMH23Mi\",\"android-app_onboarding_pin-recovery.md\":\"DYsz54uV\",\"android-app_onboarding_sign-in.md\":\"D2H-59z4\",\"android-app_onboarding_sign-up.md\":\"k4yiEoGz\",\"android-app_onboarding_verify-email.md\":\"BYkWuxro\",\"android-app_onboarding_welcome-terms.md\":\"BJTfsrcC\",\"android-app_settings_account-info.md\":\"Bst34ZFT\",\"android-app_settings_app-density.md\":\"C1gYGgWX\",\"android-app_settings_check-for-app-updates.md\":\"B_iSYaOb\",\"android-app_settings_delete-my-account.md\":\"DfeUUkMQ\",\"android-app_settings_export-profile.md\":\"DYC0U2oz\",\"android-app_settings_import-profile.md\":\"DILbrub9\",\"android-app_settings_import-whitelist.md\":\"DgH-fu0_\",\"android-app_settings_index.md\":\"X_89NHrt\",\"android-app_settings_muted-updates.md\":\"CklRkxMF\",\"android-app_settings_privacy-policy.md\":\"C5IGRwIi\",\"android-app_settings_reset-mdm-pin.md\":\"tlFn_aL3\",\"android-app_settings_support-us.md\":\"ner4hJMy\",\"android-app_settings_switch-to-hebrew.md\":\"DBz-RsTa\",\"android-app_settings_uninstall.md\":\"S9pjrqo0\",\"android-app_system_block-developer-options.md\":\"CWsTA6Gm\",\"android-app_system_block-phone-calls.md\":\"BnrvPKwN\",\"android-app_system_disable-app-settings-control.md\":\"DQ2AaKj2\",\"android-app_system_disable-factory-reset.md\":\"IrbP003D\",\"android-app_system_disable-sms-mms.md\":\"BaiJIEwv\",\"android-app_system_disallow-adding-users.md\":\"mmglRJG5\",\"android-app_system_index.md\":\"C36KpQdN\",\"android-app_updates_aurora-updater.md\":\"CEf3OkKq\",\"android-app_updates_index.md\":\"XqKAX7Ls\",\"directus.md\":\"C2RwsJFh\",\"firestore-config.md\":\"CIbSw3PD\",\"index.md\":\"C02Lv-bH\",\"vpn-wireguard.md\":\"BcYlUgyT\",\"website.md\":\"BVA5BdvV\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"TripleUMDM Docs\",\"description\":\"Internal system docs\",\"base\":\"/docs/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Android MDM app\",\"link\":\"/android-app/\"},{\"text\":\"Website TS\",\"link\":\"/website\"},{\"text\":\"Firestore config DB\",\"link\":\"/firestore-config\"},{\"text\":\"VPN + MITM proxy\",\"link\":\"/vpn-wireguard\"},{\"text\":\"Directus DB\",\"link\":\"/directus\"}],\"sidebar\":{\"/android-app/\":[{\"text\":\"Overview\",\"link\":\"/android-app/\"},{\"text\":\"Onboarding\",\"items\":[{\"text\":\"Overview\",\"link\":\"/android-app/onboarding/\"},{\"text\":\"Onboarding overview\",\"link\":\"/android-app/onboarding/onboarding-overview\"},{\"text\":\"Welcome + terms\",\"link\":\"/android-app/onboarding/welcome-terms\"},{\"text\":\"Sign in\",\"link\":\"/android-app/onboarding/sign-in\"},{\"text\":\"Sign up\",\"link\":\"/android-app/onboarding/sign-up\"},{\"text\":\"Verify email\",\"link\":\"/android-app/onboarding/verify-email\"},{\"text\":\"Password reset\",\"link\":\"/android-app/onboarding/password-reset\"},{\"text\":\"Device binding\",\"link\":\"/android-app/onboarding/device-binding\"},{\"text\":\"MDM PIN gate\",\"link\":\"/android-app/onboarding/mdm-pin-gate\"},{\"text\":\"PIN recovery\",\"link\":\"/android-app/onboarding/pin-recovery\"},{\"text\":\"Permissions check\",\"link\":\"/android-app/onboarding/permissions-check\"}]},{\"text\":\"Home tab\",\"items\":[{\"text\":\"Overview\",\"link\":\"/android-app/home/\"},{\"text\":\"Hi\",\"link\":\"/android-app/home/hi\"},{\"text\":\"Policies at a glance\",\"link\":\"/android-app/home/policies-at-a-glance\"},{\"text\":\"Did you know\",\"link\":\"/android-app/home/did-you-know\"},{\"text\":\"Policies applied counter\",\"link\":\"/android-app/home/policies-applied-counter\"},{\"text\":\"Managed apps overview\",\"link\":\"/android-app/home/managed-apps-overview\"},{\"text\":\"Whitelist summary card\",\"link\":\"/android-app/home/whitelist-summary-card\"},{\"text\":\"App update prompt\",\"link\":\"/android-app/home/app-update-prompt\"}]},{\"text\":\"System tab\",\"items\":[{\"text\":\"Overview\",\"link\":\"/android-app/system/\"},{\"text\":\"Disallow adding users\",\"link\":\"/android-app/system/disallow-adding-users\"},{\"text\":\"Disable factory reset\",\"link\":\"/android-app/system/disable-factory-reset\"},{\"text\":\"Block developer options\",\"link\":\"/android-app/system/block-developer-options\"},{\"text\":\"Disable app settings control\",\"link\":\"/android-app/system/disable-app-settings-control\"},{\"text\":\"Block phone calls\",\"link\":\"/android-app/system/block-phone-calls\"},{\"text\":\"Disable SMS/MMS\",\"link\":\"/android-app/system/disable-sms-mms\"}]},{\"text\":\"Installation\",\"items\":[{\"text\":\"Overview\",\"link\":\"/android-app/installation/\"},{\"text\":\"Disable APK install\",\"link\":\"/android-app/installation/disable-apk-install\"},{\"text\":\"Block new apps\",\"link\":\"/android-app/installation/block-new-apps\"},{\"text\":\"Allow user updates\",\"link\":\"/android-app/installation/allow-user-updates\"},{\"text\":\"Block Play Store\",\"link\":\"/android-app/installation/block-play-store\"}]},{\"text\":\"Accessibility\",\"items\":[{\"text\":\"Overview\",\"link\":\"/android-app/accessibility/\"},{\"text\":\"Android Auto quirk\",\"link\":\"/android-app/accessibility/android-auto-quirk\"},{\"text\":\"Block WhatsApp updates tab\",\"link\":\"/android-app/accessibility/block-whatsapp-updates-tab\"},{\"text\":\"Block WhatsApp channels\",\"link\":\"/android-app/accessibility/block-whatsapp-channels\"},{\"text\":\"Block status\",\"link\":\"/android-app/accessibility/block-status\"},{\"text\":\"Block AI chats\",\"link\":\"/android-app/accessibility/block-ai-chats\"},{\"text\":\"Block all in-app browsers\",\"link\":\"/android-app/accessibility/block-all-in-app-browsers\"},{\"text\":\"Block default browsers\",\"link\":\"/android-app/accessibility/block-default-browsers\"}]},{\"text\":\"Network tab\",\"items\":[{\"text\":\"Overview\",\"link\":\"/android-app/network/\"},{\"text\":\"Disable tethering and hotspot\",\"link\":\"/android-app/network/disable-tethering-and-hotspot\"},{\"text\":\"Block Wi-Fi\",\"link\":\"/android-app/network/block-wi-fi\"},{\"text\":\"Block all traffic\",\"link\":\"/android-app/network/block-all-traffic\"},{\"text\":\"Enable private DNS\",\"link\":\"/android-app/network/enable-private-dns\"},{\"text\":\"Enable VPN firewall (regular VPN, not VPN2)\",\"link\":\"/android-app/network/enable-vpn-firewall-regular-vpn-not-vpn2\"},{\"text\":\"Whitelist domains (regular VPN, not VPN2)\",\"link\":\"/android-app/network/whitelist-domains-regular-vpn-not-vpn2\"}]},{\"text\":\"Updates tab\",\"items\":[{\"text\":\"Overview\",\"link\":\"/android-app/updates/\"},{\"text\":\"Aurora updater\",\"link\":\"/android-app/updates/aurora-updater\"}]},{\"text\":\"Apps tab\",\"items\":[{\"text\":\"Overview\",\"link\":\"/android-app/apps/\"},{\"text\":\"Users apps\",\"link\":\"/android-app/apps/users-apps\"},{\"text\":\"System apps\",\"link\":\"/android-app/apps/system-apps\"},{\"text\":\"Managed apps\",\"link\":\"/android-app/apps/managed-apps\"},{\"text\":\"Hide\",\"link\":\"/android-app/apps/hide\"},{\"text\":\"Make offline\",\"link\":\"/android-app/apps/make-offline\"},{\"text\":\"Make suspended\",\"link\":\"/android-app/apps/make-suspended\"},{\"text\":\"Disable\",\"link\":\"/android-app/apps/disable\"},{\"text\":\"Block video\",\"link\":\"/android-app/apps/block-video\"},{\"text\":\"Block in-app browser\",\"link\":\"/android-app/apps/block-in-app-browser\"},{\"text\":\"Block uninstall\",\"link\":\"/android-app/apps/block-uninstall\"},{\"text\":\"Add WebView exception\",\"link\":\"/android-app/apps/add-webview-exception\"}]},{\"text\":\"Settings tab\",\"items\":[{\"text\":\"Overview\",\"link\":\"/android-app/settings/\"},{\"text\":\"Switch to Hebrew\",\"link\":\"/android-app/settings/switch-to-hebrew\"},{\"text\":\"Export profile\",\"link\":\"/android-app/settings/export-profile\"},{\"text\":\"Import profile\",\"link\":\"/android-app/settings/import-profile\"},{\"text\":\"Import whitelist\",\"link\":\"/android-app/settings/import-whitelist\"},{\"text\":\"Account info\",\"link\":\"/android-app/settings/account-info\"},{\"text\":\"Privacy policy\",\"link\":\"/android-app/settings/privacy-policy\"},{\"text\":\"Check for app updates\",\"link\":\"/android-app/settings/check-for-app-updates\"},{\"text\":\"Support us\",\"link\":\"/android-app/settings/support-us\"},{\"text\":\"App density\",\"link\":\"/android-app/settings/app-density\"},{\"text\":\"Muted updates\",\"link\":\"/android-app/settings/muted-updates\"},{\"text\":\"Reset MDM PIN\",\"link\":\"/android-app/settings/reset-mdm-pin\"},{\"text\":\"Uninstall\",\"link\":\"/android-app/settings/uninstall\"},{\"text\":\"Delete my account\",\"link\":\"/android-app/settings/delete-my-account\"}]},{\"text\":\"Invisible features\",\"items\":[{\"text\":\"Overview\",\"link\":\"/android-app/invisible-features/\"},{\"text\":\"Lifecycle + session\",\"link\":\"/android-app/invisible-features/lifecycle-session\"},{\"text\":\"Identity + admin\",\"link\":\"/android-app/invisible-features/identity-admin\"},{\"text\":\"Config + sync\",\"link\":\"/android-app/invisible-features/config-sync\"},{\"text\":\"App state sync\",\"link\":\"/android-app/invisible-features/app-state-sync\"},{\"text\":\"Network + VPN internals\",\"link\":\"/android-app/invisible-features/network-vpn-internals\"},{\"text\":\"Accessibility helpers\",\"link\":\"/android-app/invisible-features/accessibility-helpers\"},{\"text\":\"Remote control + reporting\",\"link\":\"/android-app/invisible-features/remote-control-reporting\"},{\"text\":\"Updates + notifications\",\"link\":\"/android-app/invisible-features/updates-notifications\"},{\"text\":\"Security + integrity\",\"link\":\"/android-app/invisible-features/security-integrity\"}]}],\"/\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Android app\",\"link\":\"/android-app/\"},{\"text\":\"Website\",\"link\":\"/website\"},{\"text\":\"Firestore config\",\"link\":\"/firestore-config\"},{\"text\":\"VPN + MITM proxy\",\"link\":\"/vpn-wireguard\"},{\"text\":\"Directus\",\"link\":\"/directus\"}]}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>